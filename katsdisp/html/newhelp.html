<html>
<head>
	<title>KAT7 signals help</title> 
</head>

<body onload='myloadpage()' bgcolor="#FFFFFF">
	<script>

	var timerid;
	var g_icase=-1
	var g_nlines=[1,10,20,40];
	var g_nvals=[4000,4000,4000,4000]
	var sendtime=[]
	var senttime=[]
	var rectime=[]
	
			function requestdata(){
				g_icase+=1
				if (g_icase>=g_nlines.length) clearInterval(timerid)
				sendtime[g_icase]=(new Date()).getTime();
				handle_user_event("requestdata,"+g_nlines[g_icase]+","+g_nvals[g_icase],0);
				senttime[g_icase]=(new Date()).getTime();
			}
	function receivedata(iline,nline,nvals,vals)
	{
		if (typeof(rectime[g_icase])=='undefined')
			rectime[g_icase]=[]
		rectime[g_icase][iline]=(new Date()).getTime();
		document.getElementById("timeclientusereventroundtrip").innerHTML+='nline '+nline+' nval '+nvals+' iline '+iline+' sent '+(senttime[g_icase]-sendtime[g_icase])+' rec '+(rectime[g_icase][iline]-senttime[g_icase])+' nval '+vals.length+'<br>';
	}
			
	function myloadpage(){
		connect_manager();
		timerid=setInterval(requestdata,10000)
	}
	function showhideDebug(){
		controls=document.getElementById('timingsignalsdiv');
		if (controls.style.display=='none')
			controls.style.display='block';
		else
			controls.style.display='none';
	}			

	</script>

	<div align="left" style="position: relative; left:5px; top:0px"> 
	<small>
	<A HREF="figure1">Time series</A> <A HREF="figure2">Spectrum</A> <A HREF="figure3">Waterfall</A> <A HREF="figure4">Baseline matrix</A>
	</small>
	</div>
	<div align="right" style="position: absolute; right:5px; top:6px"> 
	<small>
	 <A HREF="#" onClick="showhideDebug();">Debug</A>  <b>Help</b>
	</small>
	</div>

<div>
<p><b>Introduction</b></p>

<p>The signal displays online tool allows the user to view the real-time signals of the KAT-7 correlator remotely. Time, frequency spectrum, waterfall and baseline matrix plots are available. Some of these plots have controls that provide the user with display options.</p>

<p><b>Baseline selection</b></p>

<p>Auto correlation baselines can be selected graphically by clicking onto antennas in the antenna diagram. Similarly, cross correlation baselines can be selected by dragging from one antenna to another. When a baseline is selected, it will be displayed with a colour that matches the signal in the main figure of the page. Press the apply to all button to propagate your baseline selection to the other figures.</p>

<p>Examples of commands to enter into the select baselines text control:</p>

<table border="1">
<tr>
	<td>Command
	</td>
	<td>Equivalent
	</td>
	<td>Explanation
	</td>
</tr>
<tr>
	<td>3
	</td>
	<td>3
	</td>
	<td>select auto correlation for antenna 3
	</td>
</tr>
<tr>
	<td>1x2
	</td>
	<td>2x1
	</td>
	<td>select cross correlation between antennas 1 and 2
	</td>
</tr>
<tr>
	<td>3..6
	</td>
	<td>3,4,5,6
	</td>
	<td>select all auto correlations for antennas 3 to 6
	</td>
</tr>
<tr>
	<td>..
	</td>
	<td>1,2,3,4,5,6,7
	</td>
	<td>select all auto correlations
	</td>
</tr>
<tr>
	<td>..4
	</td>
	<td>1,2,3,4
	</td>
	<td>select all auto correlations up to antenna 4
	</td>
</tr>
<tr>
	<td>4..
	</td>
	<td>4,5,6,7
	</td>
	<td>select all auto correlations from antenna 4 and up
	</td>
</tr>
<tr>
	<td>x
	</td>
	<td>(..)x
	</td>
	<td>select all cross correlations
	</td>
</tr>
<tr>
	<td>x,..
	</td>
	<td>(..)x(..)
	</td>
	<td>select all cross and auto correlations
	</td>
</tr>
<tr>
	<td>x,!(3,4)x
	</td>
	<td>x,!3x,!4x
	</td>
	<td>select all cross correlations except those involving antennas 3 and 4
	</td>
</tr>
<tr>
	<td>(1..4)x(4,5)
	</td>
	<td>1x4,2x4,3x4,4x4,1x5,2x5,3x5,4x5
	</td>
	<td>select all cross correlations between antennas 1 to 4 and 4 and 5 including auto correlation for antenna 4
	</td>
</tr>
</table>

<p><b>Viewing Ranges</b></p>
Ranges can be specified by entering values in the minimum or maximum fields. In addition, one can enter a range in one field (either the minimum or the maximum text field) then the control will automatically set the minimum and maximum fields. If fields are left empty it signifies autoscale.

<table border="1">
<tr>
	<td>Command
	</td>
	<td>Equivalent
	</td>
	<td>Explanation
	</td>
</tr>
<tr>
	<td>-10..20
	</td>
	<td>
	</td>
	<td>Sets the minimum to -10 and the maximum to 20
	</td>
</tr>
<tr>
	<td>..
	</td>
	<td>
	</td>
	<td>Clears the minimum and maximum values (autoscale)
	</td>
</tr>
<tr>
	<td>..20
	</td>
	<td>
	</td>
	<td>Sets the maximum to 20, autoscale the minimum
	</td>
</tr>
<tr>
	<td>-100..
	</td>
	<td>
	</td>
	<td>Sets the minimum to -100, autoscale the maximum
	</td>
</tr>
</table>

<p><b>Time Ranges</b></p>
The time ranges can be specified as delays (using negative numbers) or as absolute time stamps in hh:mm:ss format. If specified as a delay the figure will scroll with time if streaming occurs. For absolute time specifications no scrolling will occur.

<table border="1">
<tr>
	<td>Command
	</td>
	<td>Equivalent
	</td>
	<td>Explanation
	</td>
</tr>
<tr>
	<td>..
	</td>
	<td>
	</td>
	<td>Clears the minimum and maximum time (autoscale)
	</td>
</tr>
<tr>
	<td>16:45:30
	</td>
	<td>
	</td>
	<td>Sets the minimum (or maximum depending on which field is entered) to the absolute time
	</td>
</tr>
<tr>
	<td>16:45:30..16:46:00
	</td>
	<td>
	</td>
	<td>Sets the minimum to 16:45:30 and maximum to 16:46:00
	</td>
</tr>
<tr>
	<td>16:45:30+40
	</td>
	<td>16:45:30..16:46:10
	</td>
	<td>Sets the minimum to 16:45:30 and maximum to 16:46:10
	</td>
</tr>
<tr>
	<td>16:45:30-120
	</td>
	<td>16:43:30..16:45:30
	</td>
	<td>Sets the minimum to 16:43:30 and the maximum to 16:45:30
	</td>
</tr>
</table>

<p><b>Flagging</b></p>

Flagging specifies which channels of the spectrum must be excluded when summing to create the time series. A csv file can be uploaded from the local machine or the field can be edited as text.

<table border="1">
<tr>
	<td>Command
	</td>
	<td>Equivalent
	</td>
	<td>Explanation
	</td>
</tr>
<tr>
	<td>..100,-100..
	</td>
	<td>..100,411..
	</td>
	<td>Flag the first and last 100 channels (if there are 512 channels)
	</td>
</tr>
<tr>
	<td>..100,150,-200,-100..
	</td>
	<td>..100,150,311,411..
	</td>
	<td>Flag the first and last 100 channels (if there are 512 channels), and also channels 150 and 311.
	</td>
</tr>
<tr>
	<td>..100,150..155,200,-100..
	</td>
	<td>..100,150,151,152,153,155,200,411..
	</td>
	<td>Flag the first and last 100 channels (if there are 512 channels), and also channels 150 to 155, as well as channel 200.
	</td>
</tr>
</table>


</div>

	<div id="timingsignalsdiv" style="display:none">
	<element id="timeserveroverview"> </element><br>
	<element id="timeinterval"> </element><br>
	<element id="linesnotdrawn"> </element><br>
	<element id="mb_received"> </element><br>
	<element id="timeservertotal"> </element><br>
	<element id="timeserverinit"> </element><br>
	<element id="timeserverselectdata"> </element><br>
	<element id="timeserverflaglogavg"> </element><br>
	<element id="timeserverprepmsg"> </element><br>
	<element id="timeserversend"> </element><br>
	<element id="timeclientinit"> </element><br>
	<element id="timeclientdraw"> </element><br>
	<element id="timereceivelist"> </element><br>
	<element id="timeclientusereventroundtrip"> </element><br>
	<div style="position: relative; display:none"><ELEMENT onmousedown = "onMouseCanvasDown(event);"><!--figure--></div>

</body>

</html>
